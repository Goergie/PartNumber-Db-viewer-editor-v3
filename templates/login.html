{% extends "layout.html" %}
{% block body %}
    <h2 align="center">Login only permitted with Google</h2>
    <br><br><br><br><br><br>
    <form id="id_token_form" action="{{ url_for('verify') }}" method="POST">
        <input name="id" id="id_token_input" type="text" hidden>
        </input>
    </form>
        <div class="row">
<!--            <div class="col-md-5"></div>-->
            <div class="col-center" id="my-signin2"></div>
        </div>
{% endblock %}
{% block script %}
<script>
    var id_token = '';
    function onSuccess(googleUser) {
        var profile = googleUser.getBasicProfile();
        id_token = googleUser.getAuthResponse().id_token;
        $("#id_token_input").val(id_token);
        $("#id_token_form").submit();
        //debug info Delete in prod
        console.log(id_token);
        console.log('Logged in as: ' + profile.getName());
        console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
        console.log('Image URL: ' + profile.getImageUrl());
        console.log('Email: ' + profile.getEmail());
    }
    function onFailure(error) {
        console.log(error);
    }
    function renderButton() {
        gapi.signin2.render('my-signin2', {
            'scope': 'profile email',
            'width': 240,
            'height': 50,
            'longtitle': true,
            'theme': 'dark',
            'onsuccess': onSuccess,
            'onfailure': onFailure
        });
    }
</script>
{% endblock %}
